<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>Mobile NixOS</title>
<link rel="stylesheet" href="styles/styles.css">
<link lang="en" rel="alternate" type="application/rss+xml" title="RSS feed (EN)" href="index.xml" />
</head>
<body class="index article">
<header>
  <nav>
    <ul>
      <li>
        <h1>
          <a href='index.html' class='is-active'>Mobile NixOS</a>
        </h1>
      </li>
      <li><a href='getting-started.html' class=''>Getting Started</a></li>
      <li><a href='resources.html' class=''>Resources</a></li>
      <li><a href='devices/index.html' class=''>Devices List</a></li>
    </ul>
  </nav>
</header>

<div id="content">
<div class="lead">
<div class="paragraph">
<p>NixOS on <strong>my</strong> phone?</p>
</div>
<div class="paragraph">
<p>It&#8217;s quickly becoming a reality! Look at the <a href="devices/index.html">devices list</a>
to see if your device is already supported. Otherwise, read about
<a href="porting-guide.html">the porting process</a> to understand if <strong>you</strong> can get NixOS
on your phone.</p>
</div>
</div>

<section class="news">
<h2 id="_news_items" class="discrete">News Items</h2>
<article>
  <header class="with-image" style="background-image: url('news/2020-12-01-november-2020-round-up.jpeg'); background-position: left center;">
    <div class="details">
      <h3><a href="news/2020-12-01-november-2020-round-up.html">November 2020 round-up</a></h3>
      <div class="date">December 1st 2020</div>
    </div>
  </header>

  <div class="contents">
  <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This update is the twelfth in a series of regular updates on the state of the
project.</p>
</div>
<div class="paragraph">
<p>Only changes that have been accepted and merged in Mobile NixOS are
chronicled here. There&#8217;s always <a href="https://github.com/NixOS/mobile-nixos/pulls">more work</a>
currently in-progress.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_notable_changes">Notable changes</h3>
<div class="paragraph">
<p>During the month <a href="https://github.com/NixOS/mobile-nixos/pulls?q=is%3Apr+merged%3A2020-11+sort%3Acreated-asc">
13 pull requests were  merged</a>.</p>
</div>
<div class="paragraph">
<p>Some major improvements landed, let&#8217;s take a peek.</p>
</div>
<div class="sect3">
<h4 id="_progress_in_stage_1">Progress in stage-1</h4>
<div class="paragraph">
<p>The boot splash utility <a href="https://github.com/NixOS/mobile-nixos/pull/233">
now shows the progress of the boot</a>. This is done with a simple progress bar
shows how much of the tasks have been handled. Long-running tasks can provide
a message to show so the user knows things aren&#8217;t necessarily hung.</p>
</div>
<div class="paragraph">
<p>Speaking of hung tasks. Our <code>init</code> <a href="https://github.com/NixOS/mobile-nixos/pull/236">
now detects when no tasks resolved in a given amount of time</a>. When this
happens, the boot is being failed with, hopefully enough context in the error
message to help the user.</p>
</div>
<div class="paragraph">
<p>Speaking of error messages. <a href="https://github.com/NixOS/mobile-nixos/pull/239">
Error messages are now less of a dead-end for our users</a>. The interface has
been reviewed to put the text message front and center. Previously we were
showing a big image because we didn&#8217;t even have text rendering at this state.
Now that we do, let&#8217;s use it.</p>
</div>
<div class="paragraph">
<p>In addition to that, the error applet is now somewhat interactive. There is
now a cancellable countdown; when the time is elapsed the kernel is crashed,
which allows the platform to do its default action (generally reboot). When
canceled, the user can select different options, either through the touch
screen, using a mouse, a keyboard or using volume-keys navigation.</p>
</div>
<div class="paragraph">
<p>The user can select to power off their device, which default action (so mashing
the power key will power off the device). Depending on whether the platform
supports it, the usual different reboot options are given.</p>
</div>
</div>
<div class="sect3">
<h4 id="_encrypted_root_filesystem_support">Encrypted root filesystem support</h4>
<div class="paragraph">
<p>Thought we were done with <em>stage-1</em> updates? No! What if it <a href="https://github.com/NixOS/mobile-nixos/pull/234">
was now able to decrypt LUKS encrypted filesystems</a>? Well it can! For now,
this is mainly the <em>plumbing</em> to make it all work. Getting a LUKS encrypted
filesystem on your device is left as an exercise to the reader.</p>
</div>
<div class="paragraph">
<p>Our <em>stage-1</em> can now ask for a passphrase during the early boot process phases.
This is done through an on-screen keyboard. For the time being the keyboard is
hard-coded to be the US QWERTY layout, and this is bad. Further improvements
are planned, but out of scope for releasing the feature. The on-screen keyboard
will be necessary for other upcoming planned features.</p>
</div>
<div class="paragraph">
<p>While using an on-screen keyboard is useful when you don&#8217;t have a physical
keyboard, <a href="https://github.com/NixOS/mobile-nixos/pull/242">physical
keyboards also can be used with that interface</a>. Similarly to the previous
note, it is hardcoded to be the US QWERTY keyboard, but the tooling chosen to
drive the keyboard mapping (libxkbcommon) will give us the ability to configure
<strong>both</strong> the on-screen and physical keyboard.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ports">Ports</h3>
<div class="paragraph">
<p>No new ports were made in November. There is still a <a href="https://mobile.nixos.org/devices/index.html">total of 15 devices</a> you can build for.</p>
</div>
</div>
  </div>
</article>

<article>
  <header class="with-image" style="background-image: url('news/2020-11-03-october-round-up.jpeg'); background-position: right center;">
    <div class="details">
      <h3><a href="news/2020-11-03-october-round-up.html">October 2020 round-up</a></h3>
      <div class="date">November 3rd 2020</div>
    </div>
  </header>

  <div class="contents">
  <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This update is the eleventh in a series of regular updates on the state of the
project.</p>
</div>
<div class="paragraph">
<p>Only changes that have been accepted and merged in Mobile NixOS are
chronicled here. There&#8217;s always <a href="https://github.com/NixOS/mobile-nixos/pulls">more work</a>
currently in-progress.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_notable_changes">Notable changes</h3>
<div class="paragraph">
<p>During the month <a href="https://github.com/NixOS/mobile-nixos/pulls?q=is%3Apr+merged%3A2020-10+sort%3Acreated-asc">
14 pull requests were  merged</a>.</p>
</div>
<div class="paragraph">
<p>Some interesting changes were made during the month, let&#8217;s look at some of
them.</p>
</div>
<div class="sect3">
<h4 id="_re_done_kernel_builder_ergonomics">Re-done kernel builder ergonomics</h4>
<div class="paragraph">
<p>The goal of this change is to <a href="https://github.com/NixOS/mobile-nixos/pull/212">
make the kernel derivations as lean as possible</a>, relying on the builder,
rather than relying on copy-pasting common patterns around.</p>
</div>
<div class="paragraph">
<p>This is a change that was needed since the project was started. Though, it
could not have happened much earlier than this late in the project. This is
because multiple different quirky kernels needed to exist to properly show what
needed to be abstracted.</p>
</div>
<div class="paragraph">
<p>With this, all common patterns for quirks have been identified and put behind
flags. Those flags are described in <a href="https://mobile.nixos.org/in-depth/kernel-builder.html">
Notes about the kernel builder</a>.</p>
</div>
<div class="paragraph">
<p>End-users shouldn&#8217;t see any difference, this will help people who make ports.</p>
</div>
<div class="sect4">
<h5 id="_compile_kernels_only_once">Compile kernels only once</h5>
<div class="paragraph">
<p>While testing the previous change, it was observed by <a href="https://github.com/danielfullmer">
@danielfullmer</a> that kernel compilation happened twice for some devices.</p>
</div>
<div class="paragraph">
<p>This was not a regression. Though looking at things trying to find problems you
are bound to see the existing flaws!</p>
</div>
<div class="paragraph">
<p>This was worked around by <a href="https://github.com/NixOS/mobile-nixos/pull/217">
doing everything in one <code>make</code> invocation</a>. The end-result is that some kernel
builds will finish twice as quickly!</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_pinephone_modem_support_improvements">Pinephone Modem support improvements</h4>
<div class="paragraph">
<p>Simply put, <a href="https://github.com/NixOS/mobile-nixos/pull/231">the modem has
been verified to work with LTE data</a>.</p>
</div>
<div class="paragraph">
<p>With that said, there&#8217;s more to it. End-users shouldn&#8217;t have to care about a
deeply-rooted <code>/sys</code> fs path to turn the modem off or on. This is why the
<code>modem-control</code> service has been added. It mirrors the modem&#8217;s state using
<code>bindsTo</code> and <code>wantedBy</code>.</p>
</div>
<div class="paragraph">
<p>With this service, the modem is better integrated with systemd, but more
importantly the user can stop and start it using <code>systemctl</code>, rather than to
dig for a particular less user-friendly path.</p>
</div>
<div class="paragraph">
<p>Calls and SMS will be tested at a later point in time. Though it is expected
that calls will require some work for the audio to work properly (a known
upstream issue).</p>
</div>
</div>
<div class="sect3">
<h4 id="_other_notable_changes">Other notable changes</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/NixOS/mobile-nixos/pull/228">#228 Boot GUI: only show relevant reboot options</a></p>
</li>
<li>
<p><a href="https://github.com/NixOS/mobile-nixos/pull/215">#215 Provide autoport in the default shell</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_ports">New ports</h3>
<div class="paragraph">
<p>One new device was merged this time.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://mobile.nixos.org/devices/razer-cheryl2.html">Razer Phone 2 (razer-cheryl2)</a> [<a href="https://github.com/samueldr">@samueldr</a>] (<a href="https://github.com/NixOS/mobile-nixos/pull/223">#223</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Bringing the <a href="https://mobile.nixos.org/devices/index.html">total of devices to 15</a>.</p>
</div>
</div>
  </div>
</article>

<article>
  <header class="with-image" style="background-image: url('news/2020-10-06-august-september-round-up.jpeg');">
    <div class="details">
      <h3><a href="news/2020-10-06-august-september-round-up.html">August and September 2020 round-up</a></h3>
      <div class="date">October 6th 2020</div>
    </div>
  </header>

  <div class="contents">
  <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This update is the tenth in a series of regular updates on the state of the
project.</p>
</div>
<div class="paragraph">
<p>Only changes that have been accepted and merged in Mobile NixOS are
chronicled here. There&#8217;s always <a href="https://github.com/NixOS/mobile-nixos/pulls">more work</a>
currently in-progress.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_notable_changes">Notable changes</h3>
<div class="paragraph">
<p>As with the last update, a big part of the <a href="https://github.com/NixOS/mobile-nixos/pulls?q=is%3Apr+merged%3A2020-08+merged%3A2020-09+sort%3Acreated-asc">
10 pull requests merged</a> were bug fixes or minor changes.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s a quick look at some of the nicer things achieved.</p>
</div>
<div class="sect3">
<h4 id="_forced_kernel_configuration_normalization">Forced kernel configuration normalization</h4>
<div class="paragraph">
<p>The <code>kernel-builder</code> infrastructure now <a href="https://github.com/NixOS/mobile-nixos/pull/204">
forces the configuration file used in its build</a> to be normalized.</p>
</div>
<div class="paragraph">
<p>What is normalization? Simply put, it&#8217;s about updating the kernel configuration
file so all of the options represent the values set in the current kernel build.</p>
</div>
<div class="paragraph">
<p>This is a somewhat breaking change, as it forces kernel configurations to be
kept up to date even if no changes were made by the maintainer. Though this
makes the final build somewhat more declarative, as options removed and new
options will be reflected in the kernel configuration in the repository.</p>
</div>
</div>
<div class="sect3">
<h4 id="_autoporter">Autoporter</h4>
<div class="paragraph">
<p>The new <a href="https://github.com/mobile-nixos/autoport">Mobile NixOS Autoporter</a>
project is an experimental tooling intended to expedite the first step in
porting to a new device.</p>
</div>
<div class="paragraph">
<p>In a few words, it finds as many facts about a given device as it can. The
current implementation uses pre-expanded factory images from OEM, but <a href="https://github.com/mobile-nixos/autoport/issues/4">
plans are</a> <a href="https://github.com/mobile-nixos/autoport/issues/5">in the work</a>
to work from files the user provide instead or in addition of.</p>
</div>
<div class="paragraph">
<p>This enables the porter-developer to start from known true values for the
device, rather than needing them to find out those values. The more valuable
ones are the subtle ones, like the USB gadget modes, or system as root.</p>
</div>
<div class="paragraph">
<p>It does not provide a complete skeleton yet. Mainly for now it&#8217;s missing the
kernel derivation. Though we might be able to provide <a href="https://github.com/mobile-nixos/autoport/issues/7">
likely source locations</a> depending on some factors.</p>
</div>
<div class="paragraph">
<p>All of this is not theoretical. We already have one port done through following
this process! Look at the pull request <a href="https://github.com/NixOS/mobile-nixos/pull/205">#205</a>
where the commits also tries to show the work that was needed to go from the
skeleton files to a working port.</p>
</div>
<div class="paragraph">
<p>Note that this port was made easier by the presence of another Snapdragon 660
port existing. Many quirks end up working similarly between devices on the same
base platform.</p>
</div>
<div class="paragraph">
<p>Hopefully this will help some of you take the plunge into trying to make a new
port! Though note that this does not replace the still non-existent
documentation about porting guidelines. It might still not be trivial.</p>
</div>
</div>
<div class="sect3">
<h4 id="_other_notable_changes">Other notable changes</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/NixOS/mobile-nixos/pull/193">#193 pine64-pinephone-braveheart: August 2020 updates</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Making <code>motorola-addison</code> much more usable:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/NixOS/mobile-nixos/pull/195">#195 initrd: Make compression method an option</a></p>
</li>
<li>
<p><a href="https://github.com/NixOS/mobile-nixos/pull/196">#196 motorola-addison: Build firmware and enable wcnss</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_ports">New ports</h3>
<div class="paragraph">
<p>One new device was merged this time.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://mobile.nixos.org/devices/sony-pioneer.html">Sony Xperia XA2 (sony-pioneer)</a> [<a href="https://github.com/samueldr">@samueldr</a>] (<a href="https://github.com/NixOS/mobile-nixos/pull/205">#205</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Bringing the <a href="https://mobile.nixos.org/devices/index.html">total of devices to 14</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_closing_words">Closing words</h3>
<div class="paragraph">
<p>The last month&#8217;s update was skipped due to the lower amount of work being
complete, the main contributor (me, samueldr) was tied-up working on
implementing the <a href="https://nixos.org/">NixOS.org redesign</a>. Fear not, it&#8217;s
not lack of motivation, but temporary engagements that slowed things down. For
the time being this project is still my main focus, and I hope it can stay for
longer.</p>
</div>
</div>
  </div>
</article>

<article>
  <header class="with-image" style="background-image: url('news/2020-08-04-july-2020-round-up.jpeg');">
    <div class="details">
      <h3><a href="news/2020-08-04-july-2020-round-up.html">July 2020 round-up</a></h3>
      <div class="date">August 4th 2020</div>
    </div>
  </header>

  <div class="contents">
  <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This update is the ninth in a series of regular updates on the state of the
project.</p>
</div>
<div class="paragraph">
<p>Only changes that have been accepted and merged in Mobile NixOS are
chronicled here. There&#8217;s always <a href="https://github.com/NixOS/mobile-nixos/pulls">more work</a>
currently in-progress.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_notable_changes">Notable changes</h3>
<div class="paragraph">
<p>As with last month, a big part of the <a href="https://github.com/NixOS/mobile-nixos/pulls?q=is%3Apr+merged%3A2020-07+sort%3Acreated-asc">
10 pull requests merged</a> were bug fixes or minor changes. Though some valuable
work was also finished.</p>
</div>
<div class="sect3">
<h4 id="_asus_zenfone_max_plus_m1">Asus Zenfone Max Plus (M1)</h4>
<div class="paragraph">
<p>The port for <a href="https://github.com/NixOS/mobile-nixos/pull/175">asus-x018d</a>
is mainly notable for being the only alternative system to the OEM-provided
Android system, with the exception to a TWRP that is using the OEM-built kernel.</p>
</div>
<div class="paragraph">
<p>This means that, for the first time, Mobile NixOS this is the only alternative
system for a device, including other Android-based systems.</p>
</div>
<div class="paragraph">
<p>Finishing with a last note, this device has an older Mediatek SoC, compared to
the other ported Mediatek device. There is not much to say, except that it was
found that older Mediatek devices may exhibit a similar quirk to Qualcomm
devices, where the framebuffer has to be refreshed explicitly for the display
to be updated.</p>
</div>
</div>
<div class="sect3">
<h4 id="_external_device_definitions">External device definitions</h4>
<div class="paragraph">
<p>I hesitate to openly discuss about this pull request, as it might make
contributors think they should not contribute their devices back. <a href="https://github.com/NixOS/mobile-nixos/pull/162">#162</a>
adds a mechanism to maintain and build external device definitions.</p>
</div>
<div class="paragraph">
<p>These external definitions should only be used for devices that are not welcome
to the main project. The main reason a device would not be welcome is if it is
not a “Mobile device”. An example of such a device is the <a href="https://github.com/samueldr/mobile-nixos-extra-devices/tree/master/devices/pine64-pinebookpro">Pinebook Pro</a>,
which is a laptop. Another example would be porting to SBCs like a Raspberry Pi.</p>
</div>
</div>
<div class="sect3">
<h4 id="_updates_for_the_boot_gui">Updates for the boot GUI</h4>
<div class="paragraph">
<p>This change, <a href="https://github.com/NixOS/mobile-nixos/pull/189">#189</a>, is
where most if this month&#8217;s development time was spent. The toolkit used for the
boot GUI has been forked and adapted to serve the goal of providing a GUI for
mobile devices better.</p>
</div>
<div class="paragraph">
<p>As part of the changes, some minor UX (User eXperience) changes have been made,
but more importantly, major changes like properly supporting mouse and touch
screens in an independent manner, and providing keyboard-driven input. This
also adds support to navigate the GUI with the volume keys and the power
button, which is a common scheme used to provide a fall-back navigation when
touchscreen support is possible.</p>
</div>
<div class="paragraph">
<p>Except for the new way added to interact with the GUI, there are no major
changes to how the GUI is used. Though the work is a first step to provide more
in-depth options during the boot process, like tracking progress, and required
user input for actions during boot like passphrase input.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_ports">New ports</h3>
<div class="paragraph">
<p>One new device was merged this month.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://mobile.nixos.org/devices/asus-x018d.html">Asus Zenfone Max Plus (M1) (asus-x018d)</a> [<a href="https://github.com/samueldr">@samueldr</a>] (<a href="https://github.com/NixOS/mobile-nixos/pull/175">#175</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Bringing the <a href="https://mobile.nixos.org/devices/index.html">total of devices to 13</a>.</p>
</div>
</div>
  </div>
</article>

<article>
  <header class="with-image" style="background-image: url('news/2020-07-07-june-2020-round-up.jpeg'); background-position: right center;">
    <div class="details">
      <h3><a href="news/2020-07-07-june-2020-round-up.html">June 2020 round-up</a></h3>
      <div class="date">July 7th 2020</div>
    </div>
  </header>

  <div class="contents">
  <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This update is the eighth in a series of regular updates on the state of the
project.</p>
</div>
<div class="paragraph">
<p>Only changes that have been accepted and merged in Mobile NixOS are
chronicled here. There&#8217;s always <a href="https://github.com/NixOS/mobile-nixos/pulls">more work</a>
currently in-progress.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_notable_changes">Notable changes</h3>
<div class="paragraph">
<p>Most of the <a href="https://github.com/NixOS/mobile-nixos/pulls?q=is%3Apr+merged%3A2020-06+sort%3Acreated-asc">
9 pull requests merged</a> were trivial or minor changes. Though there&#8217;s
still some notable changes.</p>
</div>
<div class="sect3">
<h4 id="_pinephone_bluetooth_support">Pinephone bluetooth support</h4>
<div class="paragraph">
<p>It turns out all it needed was a trivial fix. <a href="https://github.com/NixOS/mobile-nixos/pull/163">
Giving it the firmware it wanted</a> adds proper support for bluetooth on the
Pinephone.</p>
</div>
<div class="paragraph">
<p>If you are using the <code>examples/demo</code> rootfs, its configuration does not
currently configure the system for audio with bluetooth. The instructions to
configure audio for bluetooth <a href="https://nixos.wiki/wiki/Bluetooth#Using_Bluetooth_headsets_with_PulseAudio">
are the same as usual</a>, as Mobile NixOS is composed on top of NixOS.</p>
</div>
</div>
<div class="sect3">
<h4 id="_redmi_note_8_pro">Redmi Note 8 Pro</h4>
<div class="paragraph">
<p>The port for <a href="https://github.com/NixOS/mobile-nixos/pull/171">xiaomi-begonia</a>
is mainly notable for being the first port for a Mediatek SoC.</p>
</div>
<div class="paragraph">
<p>I am singling out this port as a proof that the <a href="https://samuel.dionne-riel.com/blog/2020/04/24/mobile-nixos-breadth-first-development.html">
breadth-first development</a> style is working well. Since Mobile NixOS had many
abstractions needed for the existing different platforms, this new platform,
and device, was ported without a sweat.</p>
</div>
<div class="paragraph">
<p>This also paves the way for other Mediatek ports by providing a working
example. Coupled with <a href="https://github.com/NixOS/mobile-nixos/pull/175">#175</a>,
another, older, Mediatek device (merged in early July), there is enough
material to give clues for future ports by community members.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_ports">New ports</h3>
<div class="paragraph">
<p>One new device was merged this month.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://mobile.nixos.org/devices/xiaomi-begonia.html">Xiaomi Redmi Note 8 Pro (xiaomi-begonia)</a> [<a href="https://github.com/samueldr">@samueldr</a>] (<a href="https://github.com/NixOS/mobile-nixos/pull/171">#171</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Bringing the <a href="https://mobile.nixos.org/devices/index.html">total of devices to 12</a>.</p>
</div>
</div>
  </div>
</article>

<article>
  <header class="without-image" style="">
    <div class="details">
      <h3><a href="news/2020-06-02-may-2020-round-up.html">May 2020 round-up</a></h3>
      <div class="date">June 2nd 2020</div>
    </div>
  </header>

  <div class="contents">
  <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This update is the seventh in a series of regular updates on the state of the
project.</p>
</div>
<div class="paragraph">
<p>Only changes that have been accepted and merged in Mobile NixOS are
chronicled here. There&#8217;s always <a href="https://github.com/NixOS/mobile-nixos/pulls">more work</a>
currently in-progress.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_notable_changes">Notable changes</h3>
<div class="paragraph">
<p><a href="https://github.com/NixOS/mobile-nixos/pulls?q=is%3Apr+merged%3A2020-05+sort%3Acreated-asc">11 PRs were merged</a>
during the month. Changes are mostly cleanup and documentation related.</p>
</div>
<div class="sect3">
<h4 id="_documentation_changes">Documentation changes</h4>
<div class="paragraph">
<p>The biggest change is the addition of <a href="https://mobile.nixos.org/in-depth/devices.html">
an overview of the terms used to define a device</a> (<a href="https://github.com/NixOS/mobile-nixos/pull/148">#148</a>).
This documentation section should help better understand how devices are composed.</p>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/NixOS/mobile-nixos/blob/master/README.adoc">README</a> (<a href="https://github.com/NixOS/mobile-nixos/pull/138">#138</a>) as
shown on GitHub has been reviewed to better guide users and contributors around
the ecosystem, borrowing the organization of the main Nixpkgs README. Though the
main reason for this change is that the README started to diverge with the
documentation. Removing all examples and referring to the actual documentation
files reduces the burden of maintaining multiple documentation fragments.</p>
</div>
</div>
<div class="sect3">
<h4 id="_code_and_architecture_cleanup">Code and architecture cleanup</h4>
<div class="paragraph">
<p>Through some of the pull requests, a bunch of either dead, or ossified code was
found and removed. The main user-facing change is the <a href="https://github.com/NixOS/mobile-nixos/pull/152">removal of <code>device.info</code></a>.</p>
</div>
<div class="paragraph">
<p>The <code>device.info</code> option was a mixed bag of misshapen, undefined options that were
at the foundation of all device definitions. The replacement are discrete well-defined
options that are defined in understandable categories. Systems define options that
they use, making it easier to understand why an option is defined.</p>
</div>
<div class="paragraph">
<p>The main consequence of that change is that the current work-in-progress ports
will need to be reviewed to use the new options.</p>
</div>
<div class="paragraph">
<p>As part of <a href="https://github.com/NixOS/mobile-nixos/pull/155">#155</a>, additional
cleanup was made in
<a href="https://github.com/NixOS/mobile-nixos/pull/155/commits/09fed68bcf88a28081e90cd3f593cb182e11f814">the</a>
<a href="https://github.com/NixOS/mobile-nixos/pull/155/commits/7ee81a9cadcc6f476332e4b656078654db2e24c5">first</a>
<a href="https://github.com/NixOS/mobile-nixos/pull/155/commits/22eddafd91f6ba6f6b92f3ae429b8f1f0aaa3137">few</a>
<a href="https://github.com/NixOS/mobile-nixos/pull/155/commits/30ff772fbd7fa5d0ff2b0e38299d802a285b46f9">commits</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_new_exampleshello_system">New <code>examples/hello</code> system</h4>
<div class="paragraph">
<p>While technically a new feature, <a href="https://github.com/NixOS/mobile-nixos/pull/155">
the new examples/hello system (#155)</a> is more of a first-user-experience "bugfix"
than a useful new feature.</p>
</div>
<div class="paragraph">
<p>This introduces a new example system that can be cross-compiled entirely, <strong>and
shows an interface to the end-user</strong>. This helps fix the biggest complaint about
the project: the default build looks as if the system has stopped responding.</p>
</div>
<div class="paragraph">
<p>Though this is not actually fixing that complaint, it does not replace the default
build output. Users making a new port, or testing an existing port, will rather
<a href="https://github.com/NixOS/mobile-nixos/blob/c0c93961cfe6c373d200103f1df4911f20fa55a8/default.nix#L99-L102">be encouraged</a>
to first try building and using this example to confirm the port works.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code> $ nix-build examples/hello --argstr device DEVICE-NAME -A build.default</code></pre>
</div>
</div>
<div class="paragraph">
<p>A planned addition to this feature will be more features to test and validate support
for different subsystems of the device. Currently this only tests the touchscreen
(through requiring it for navigation) and validates the display shows the colours
appropriately.</p>
</div>
</div>
<div class="sect3">
<h4 id="_additional_highlights">Additional highlights</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/NixOS/mobile-nixos/pull/141">#141 initrd-usb: provide modules required for gadgets in initrd</a>,
which handles modules in modular mainline-based kernels and stage-1.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ports">Ports</h3>
<div class="paragraph">
<p>No new port were made in May. There is still a
<a href="https://mobile.nixos.org/devices/index.html">total of 11 devices</a> you can
build for.</p>
</div>
</div>
  </div>
</article>

<article>
  <header class="with-image" style="background-image: url('news/2020-05-06-april-2020-round-up.jpeg'); background-position: right center;">
    <div class="details">
      <h3><a href="news/2020-05-06-april-2020-round-up.html">April 2020 round-up</a></h3>
      <div class="date">May 6th 2020</div>
    </div>
  </header>

  <div class="contents">
  <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This update is the sixth in a series of regular updates on the state of the
project.</p>
</div>
<div class="paragraph">
<p>Only changes that have been accepted and merged in Mobile NixOS are
chronicled here. There&#8217;s always <a href="https://github.com/NixOS/mobile-nixos/pulls">more work</a>
currently in-progress.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_notable_changes">Notable changes</h3>
<div class="paragraph">
<p><a href="https://github.com/NixOS/mobile-nixos/pulls?q=is%3Apr+merged%3A2020-04+sort%3Acreated-asc">11 PRs were merged</a>
during the month. Not an exciting month with fun and visible progress, but
let&#8217;s point out interesting changes</p>
</div>
<div class="sect3">
<h4 id="_device_specific_website_pages">Device specific website pages</h4>
<div class="paragraph">
<p>The <em><a href="https://mobile.nixos.org/devices/">Devices List</a></em> section is now
formatted as a table, and links to one page per device.</p>
</div>
<div class="paragraph">
<p>This page can contain device-specific notes, and generally contains generic
instructions depending on the device type. The side-bar uses generated
content, but the page will use the <code>README.adoc</code> file when found in the device
directory.</p>
</div>
<div class="paragraph">
<p>All of this is part of <a href="https://github.com/NixOS/mobile-nixos/pull/120">PR #120</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_supported_way_to_include_from_system_configuration">Supported way to include from system configuration</h4>
<div class="paragraph">
<p>In <a href="https://github.com/NixOS/mobile-nixos/pull/123">PR #123</a> a supported way
to include a device configuration to the system configuration was added. The
<a href="https://mobile.nixos.org/getting-started.html">Getting Started</a> page
explains the details.</p>
</div>
<div class="paragraph">
<p>This is useful when combined with the next higlighted changes. The device
specific configuration doesn&#8217;t have to be handled by the end-user, the Mobile
NixOS configuration handles it.</p>
</div>
</div>
<div class="sect3">
<h4 id="_wcnss_wlan_quirk">WCNSS WLAN <em>quirk</em></h4>
<div class="paragraph">
<p><a href="https://github.com/NixOS/mobile-nixos/pull/126">PR #126</a> adds support for
WCNSS WLAN in Mobile NixOS, while enabling it for the only device that supports
it.</p>
</div>
<div class="paragraph">
<p>This is the simplest Wi-Fi setup for Qualcomm-based hardware. Sadly, for other
devices it&#8217;s much more involved.</p>
</div>
<div class="paragraph">
<p>Though, this does mean that we now have Wi-Fi support for one more device!</p>
</div>
<div class="paragraph">
<p><strong>Bonus change</strong>: Buried in that same PR, we now use <code>boot.initrd.enable = false</code>
rather than using <code>isContainer</code>. This fixes a couple of weird and annoying
issues with the running system.</p>
</div>
</div>
<div class="sect3">
<h4 id="_device_specific_polishing">Device-specific polishing</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/NixOS/mobile-nixos/pull/126">PR #126</a></p>
</li>
<li>
<p><a href="https://github.com/NixOS/mobile-nixos/pull/128">PR #128</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These start implementing some <em>polishing</em>, in what I hope becomes the gold
standard for device ports.</p>
</div>
<div class="paragraph">
<p>First, we configure the LEDs so the Linux kernel controls it during
boot (<a href="https://github.com/NixOS/mobile-nixos/blob/6be1a3bf0ca7d4f956b7dab4bab932071c402026/devices/asus-z00t/kernel/0002-ze550kl-Green-LED-now-defaults-to-on.patch#L21-L30">z00t</a>,
<a href="https://github.com/NixOS/mobile-nixos/blob/6be1a3bf0ca7d4f956b7dab4bab932071c402026/devices/oneplus-oneplus3/kernel/0001-oneplus3-Configure-LEDs-using-kernel-triggers.patch#L38-L41">oneplus3</a>).
This provides a tangible proof to the end-user that the kernel is
currently in control and running.</p>
</div>
<div class="paragraph">
<p>Then, for <code>asus-z00t</code>, some kernel cleanup patches have been added. The first
kind of change is to remove <em>idiotic</em> behaviour from the OEM kernel, like
<a href="https://github.com/samueldr-wip/mobile-nixos-wip/blob/640f2d4c794c2066797a31157c324c437b200250/devices/asus-z00t/kernel/0001-firmware-class-Remove-rude-firmware-path-trampling.patch">
trampling over the kernel module load path</a>. The second is more subtle, but
welcomed when reading <code>dmesg</code>: reduce the useless logging present in some
modules. The amount of logging is useless.</p>
</div>
<div class="paragraph">
<p>Finally, for <code>oneplus-oneplus3</code>, there&#8217;s a <a href="https://github.com/NixOS/mobile-nixos/commit/c7a121fbaeedfd8e493127355588b7a511ad393d">
<em>quirk</em> to fix USB OTG support</a> during boot. I don&#8217;t think any other device
will need it, from a quick glance, but it&#8217;s still a good example of how to
implement a <em>quirk</em>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ports">Ports</h3>
<div class="paragraph">
<p>No new port were made in April. There is still a
<a href="https://mobile.nixos.org/devices/index.html">total of 11 devices</a> you can
build for.</p>
</div>
</div>
  </div>
</article>

<article>
  <header class="with-image" style="background-image: url('news/2020-04-07-march-2020-round-up.jpeg');">
    <div class="details">
      <h3><a href="news/2020-04-07-march-2020-round-up.html">March 2020 round-up</a></h3>
      <div class="date">April 7th 2020</div>
    </div>
  </header>

  <div class="contents">
  <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This update is the fifth in a series of regular updates on the state of the
project.</p>
</div>
<div class="paragraph">
<p>Only changes that have been accepted and merged in Mobile NixOS are
chronicled here. There&#8217;s always <a href="https://github.com/NixOS/mobile-nixos/pulls">more work</a>
currently in-progress.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_notable_changes">Notable changes</h3>
<div class="paragraph">
<p><a href="https://github.com/NixOS/mobile-nixos/pulls?q=is%3Apr+merged%3A2020-03+sort%3Acreated-asc">17 PRs were merged</a>
during the month. (The link says 18, but one of them was, to me, late in
February, read the previous news item).</p>
</div>
<div class="paragraph">
<p>Let&#8217;s look at some of these.</p>
</div>
<div class="sect3">
<h4 id="_pine64_pinephone_braveheart">Pine64 Pinephone “Braveheart”</h4>
<div class="paragraph">
<p>This was teased about on the <a href="https://twitter.com/samueldr/status/1237478576443854848">
author&#8217;s twitter account</a>. <a href="https://www.pine64.org/pinephone/">The inexpensive
Pinephone</a> is the latest new device added to Mobile NixOS.</p>
</div>
<div class="paragraph">
<p>This brings a bit more than only a new device. This is the fourth system type
added to Mobile NixOS. The added system type (U-Boot) in theory will give us
the ability to support any U-Boot-based system in a common way. In practice the
still unmerged and WIP <a href="https://github.com/NixOS/mobile-nixos/pull/94">#94</a>
shows how this is true by using U-Boot with another Pine64 device, the
<em>Pinebook Pro</em>.</p>
</div>
<div class="paragraph">
<p>A nice thing that was verified again with this new device port is that the
stage-2 image (the rootfs, the system.img) is indeed universal. It is using the
same AArch64 build of the system image as Android-based devices, and
Depthcharge-based devices.</p>
</div>
<div class="paragraph">
<p>Our build for the Pinephone relies on the <a href="https://gitlab.com/pine64-org/linux">
downstream kernel from the Pine64 community</a>, with only one added patch.
The same is done for the U-Boot build.</p>
</div>
<div class="paragraph">
<p>The added patches are user-experience-focused patches that are using the RGB
LED of the phone to show the boot status.</p>
</div>
<div class="paragraph">
<p>Other than that, the hardware support is not complete, but it is supported at
the same level as other devices, plus Wi-Fi working.</p>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/NixOS/mobile-nixos/pull/96">PR #96</a> for all the details.</p>
</div>
</div>
<div class="sect3">
<h4 id="_hydra_builds">Hydra builds</h4>
<div class="paragraph">
<p>This is not entirely an in-repository change. There&#8217;s <a href="https://github.com/NixOS/mobile-nixos/pull/97">#97</a>
and <a href="https://github.com/NixOS/mobile-nixos/pull/113">#133</a> that are relevant
to this. The <a href="https://hydra.nixos.org/jobset/mobile-nixos/unstable">mobile-nixos:unstable jobset</a>
on Hydra is the other part of the puzzle.</p>
</div>
<div class="paragraph">
<p>What this gives us is automatic continuous builds of Mobile NixOS against the
<code>nixos-unstable</code> NixOS channel. From this, we can track changes that break the
Mobile NixOS builds, and track internal breakage to some parts of Mobile NixOS.</p>
</div>
<div class="paragraph">
<p>This is not even the best part. As can be seen in <a href="https://github.com/NixOS/mobile-nixos/pull/113">#133</a>,
we are now delivering up-to-date stage-2 rootfs, which allows end-users without
the required hardware to <a href="https://mobile.nixos.org/getting-started.html#_using_a_pre_built_system_img">
bootstrap themselves using a pre-built image</a>. The requirement to have a native
AArch64 machine to build the system image is no more. While not ideal, users
could make use of their phone to build a customized image, or simply, do a
<code>nixos-rebuild</code> on it.</p>
</div>
<div class="paragraph">
<p>It already paid its worth in gold, as by the time this was developed, two
regressions were spotted and quickly fixed. And furthermore, I hope that the
exercising of the cross-compilation framework will help the NixOS developers
working on making cross-compilation better in NixOS.</p>
</div>
</div>
<div class="sect3">
<h4 id="_other_mentions">Other mentions</h4>
<div class="ulist">
<ul>
<li>
<p>Using GitHub Actions, <a href="https://github.com/NixOS/mobile-nixos/pull/112">#112</a>
checks new PRs for some simple breakage.</p>
</li>
<li>
<p>Developers can now use <code>nconfig</code> to configure their kernel using the “porcelain”
<code>bin/menuconfig</code>, as added in <a href="https://github.com/NixOS/mobile-nixos/pull/109">#109</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ports">Ports</h3>
<div class="paragraph">
<p>One new device has been merged during March.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Pine64 Pinephone “Braveheart” (pine64-pinephone-braveheart) [<a href="https://github.com/samueldr">@samueldr</a>] (<a href="https://github.com/NixOS/mobile-nixos/pull/96">#96</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Bringing the <a href="https://mobile.nixos.org/devices/index.html">total of devices to 11</a>.</p>
</div>
</div>
  </div>
</article>

<article>
  <header class="with-image" style="background-image: url('news/2020-03-03-february-2020-round-up.jpeg');">
    <div class="details">
      <h3><a href="news/2020-03-03-february-2020-round-up.html">February 2020 round-up</a></h3>
      <div class="date">March 3rd 2020</div>
    </div>
  </header>

  <div class="contents">
  <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This update is the fourth in a series of regular updates on the state of the
project.</p>
</div>
<div class="paragraph">
<p>Only changes that have been accepted and merged in Mobile NixOS are
chronicled here. There&#8217;s always <a href="https://github.com/NixOS/mobile-nixos/pulls">more work</a>
currently in-progress.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_notable_changes">Notable changes</h3>
<div class="paragraph">
<p><a href="https://github.com/NixOS/mobile-nixos/pulls?utf8=%E2%9C%93&amp;q=is%3Apr+merged%3A2020-02+merged%3A2020-03-01">3 PRs were merged</a>
during the month. This is not cheating, the last merged PR was merged late on
the 29th.</p>
</div>
<div class="paragraph">
<p>This is not development slowing down. Far from it. <a href="https://github.com/mobile-nixos/">Four new projects</a>
were added to the Mobile NixOS GitHub organization related to this month&#8217;s
work. Keep on reading.</p>
</div>
<div class="sect3">
<h4 id="_graphical_boot_selection">Graphical boot selection</h4>
<div class="paragraph">
<p>Hot on the heels of the <a href="https://mobile.nixos.org/news/2020-02-04-january-2020-round-up.html">re-written init</a>,
and as teased, a working graphical boot selection is now available for Mobile
NixOS platforms.</p>
</div>
<div class="paragraph">
<p>There is more than meets the eye in <a href="https://github.com/NixOS/mobile-nixos/pull/80">pull request #80</a>.</p>
</div>
<div class="paragraph">
<p>To make this possible, a GUI toolkit of relatively small weight has to be
found. After some research, it was found in the <a href="https://littlevgl.com/">LittlevGL</a>
library. While it is geared more towards <em>actual</em> embedded development, it does
have a Linux framebuffer backend, support for evdev input. This is all standard
stuff that is well supported on all targets. What is really nice with that
library is it also supports a “simulator” target, which is basically an SDL
window.</p>
</div>
<div class="paragraph">
<p>With that said, I personally don&#8217;t want to write C, especially in complex use
cases. I already worked on mruby integration for the Mobile NixOS stage-1. It
was only natural to write <a href="https://github.com/mobile-nixos/mruby-lvgui">mruby bindings for LittleVGL</a>.</p>
</div>
<div class="paragraph">
<p>With all the exposition done. What does this look like? The header image of
this news post is composed of four devices running the GUI. An actual
screenshot of the GUI follows, for better clarity.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="news/2020-03-03-boot-gui.png" alt="Screenshot of generation selection" width="600">
</div>
</div>
<div class="paragraph">
<p>This is not a feature complete generic replacement for a bootloader. Though, it
can become one when kexec support is added in the future.</p>
</div>
<div class="paragraph">
<p>Additionally, as touched upon in the pull request, these bindings will allow us
to improve the graphical boot process. In a future improvement we&#8217;ll be able to
add information about the current running step, and better failure state
reporting.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ports">Ports</h3>
<div class="paragraph">
<p>No new port were made in February. There is still a
<a href="https://mobile.nixos.org/devices/index.html">total of 10 devices</a> you can
build for.</p>
</div>
</div>
  </div>
</article>

<article>
  <header class="with-image" style="background-image: url('news/2020-02-04-january-2020-round-up.jpeg');">
    <div class="details">
      <h3><a href="news/2020-02-04-january-2020-round-up.html">January 2020 round-up</a></h3>
      <div class="date">February 4th 2020</div>
    </div>
  </header>

  <div class="contents">
  <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This update is the third in a series of regular updates on the state of the
project.</p>
</div>
<div class="paragraph">
<p>Usually, only changes that have been accepted and merged in Mobile NixOS in the
given month are chronicled here. There&#8217;s always
<a href="https://github.com/NixOS/mobile-nixos/pulls">more work</a> currently in-progress.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_notable_changes">Notable changes</h3>
<div class="paragraph">
<p>Only <a href="https://github.com/NixOS/mobile-nixos/pulls?utf8=%E2%9C%93&amp;q=is%3Apr+merged%3A2020-01">1 PR was merged</a>
during the month. Though, keep on reading, as one of the biggest PR, started in
mid-December, was the main focus of the month.</p>
</div>
<div class="sect3">
<h4 id="_new_stage_1_init">New Stage-1 init</h4>
<div class="paragraph">
<p>This is quite the misnomer, while true, that the PR mainly introduced a
completely re-done init, it brought much more.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"New-style" USB gadget (gadgetfs) handling.</p>
</li>
<li>
<p>USB Networking for newer devices.</p>
</li>
<li>
<p>Vendor partition firmware loading.</p>
</li>
<li>
<p>Logs multiplexing and saving in stage-1.</p>
</li>
<li>
<p>Proper reboot and poweroff in stage-1.</p>
</li>
<li>
<p>Actual handling of NixOS-configured <code>specialFileSystems</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This new init is built using a dependencies-based system, reducing the
complexities from the inflexible "big script" approach of the previous init.
With this new approach, we can simply dump all of the things we need to happen
in the init, tell them how they&#8217;re linked, and boot. The current implementation
is naïve, but even with a naïve approach, the benefits are apparent. First, the
developer does not need to care about the ordering of things, only describing
what has to be, and what to do. Then, the relatively surprising part: this made
things a bit quicker to boot.</p>
</div>
<div class="paragraph">
<p>This reduced reliance on sleep and wait times during the boot to provide
assurance that things were ready, meaning that steps happen much quicker in
succession. To the annoyance of the author, this means that the
well-choreographed boot images whizz by too quickly, reducing their
meaningfulness.</p>
</div>
<div class="paragraph">
<p>In the end, this is a hidden change, that serves mainly to ensure a rock-solid
foundation for what&#8217;s coming soon.</p>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/NixOS/mobile-nixos/pull/66">the PR</a> for more details.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_upcoming_changes">Upcoming changes</h3>
<div class="paragraph">
<p>Speaking of coming soon, As previewed <a href="https://twitter.com/samueldr/status/1223139451196661760">in a tweet</a>,
work is in progress to provide a graphical interface that can be used in early
boot. This can be used to make a "recovery" system tailored to the project&#8217;s
need, and more importantly, allow interaction in the boot process.</p>
</div>
<div class="paragraph">
<p>The main focus of early interaction is to allow selecting a generation to boot
into. This is part of the NixOS experience, and is currently missing. Another
benefit to an early UI is that it will give us the opportunity to enter a
passphrase to unlock an eventually coming encrypted system.</p>
</div>
<div class="paragraph">
<p>Keep your eyes peeled for the coming PR!</p>
</div>
</div>
<div class="sect2">
<h3 id="_ports">Ports</h3>
<div class="paragraph">
<p>No new port were made in January. There is still a
<a href="https://mobile.nixos.org/devices/index.html">total of 10 devices</a> you can
build for.</p>
</div>
</div>
  </div>
</article>

<article>
  <header class="with-image" style="background-image: url('news/2020-01-08-december-2019-round-up.jpeg');">
    <div class="details">
      <h3><a href="news/2020-01-08-december-2019-round-up.html">December 2019 round-up</a></h3>
      <div class="date">January 8th 2020</div>
    </div>
  </header>

  <div class="contents">
  <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This update is the second in a series of regular updates on the state of the
project.</p>
</div>
<div class="paragraph">
<p>Only changes that have been accepted and merged in Mobile NixOS are
chronicled here. There&#8217;s always <a href="https://github.com/NixOS/mobile-nixos/pulls">more work</a>
currently in-progress.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_notable_changes">Notable changes</h3>
<div class="paragraph">
<p>Among the changes, and the <a href="https://github.com/NixOS/mobile-nixos/pulls?utf8=%E2%9C%93&amp;q=is%3Apr+merged%3A2019-12">10 PRs merged</a>,
these changes are highlighted.</p>
</div>
<div class="sect3">
<h4 id="_make_the_demo_more_useful_on_a_touch_device">Make the demo more useful on a touch device</h4>
<div class="paragraph">
<p>These are changes to the "example" system. This is a finalized version of the
demo system that was running on the devices during NixCon 2019.</p>
</div>
<div class="paragraph">
<p>The main difference is that this is not a raw XFCE desktop, but a
pre-configured system that is more accessible on touch devices. The onboard
on-screen keyboard is configured to be of a useful height. Additionally, XFWM
has been replaced with Awesome WM configured to maximize all windows.</p>
</div>
<div class="paragraph">
<p>This is still not an appropriate mobile environment, only a collection of
configuration that makes it work well enough to test things up.</p>
</div>
<div class="paragraph">
<p>Read more in <a href="https://github.com/NixOS/mobile-nixos/pull/63">pull request #63</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_enhance_qemu_device">Enhance QEMU Device</h4>
<div class="paragraph">
<p>The <code>x86_64</code> based QEMU VM has seen fixes to, first, make it actually work
right.</p>
</div>
<div class="paragraph">
<p>What&#8217;s more interesting in this PR is the patched VGA BIOS that rotates the
expected resolutions (720p, 1080p) on their side in portrait mode. This is
especially helpful when working on purely software things like improving the
example system.</p>
</div>
<div class="paragraph">
<p>These changes are part of
<a href="https://github.com/NixOS/mobile-nixos/pull/59">pull request #59</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_different_stage_1_fixes">Different stage-1 fixes</h4>
<div class="paragraph">
<p>The root filesystem is configured to expand to the size of its backing
partition during boot.
Part of <a href="https://github.com/NixOS/mobile-nixos/pull/61">pull request #61</a>.</p>
</div>
<div class="paragraph">
<p>Critical failure states <a href="https://mobile.nixos.org/in-depth/stage-1.html#_about_sad_phone_screens">are graphically reported</a>.
As documented, a full-screen color-coded "sad phone" gives a general idea of
the error encountered.
Part of <a href="https://github.com/NixOS/mobile-nixos/pull/58">pull request #58</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_other_notable_changes">Other notable changes</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/NixOS/mobile-nixos/pull/41">#41 fixing adb for stage-2.</a></p>
</li>
<li>
<p><a href="https://github.com/NixOS/mobile-nixos/pull/67">#67 which fixes spurious framebuffer failures on Google Pixel 2.</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ports">Ports</h3>
<div class="paragraph">
<p>One new device has been merged during December.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Xiaomi Redmi Note 7 (xiaomi-lavender) [<a href="https://github.com/samueldr">@samueldr</a>] (<a href="https://github.com/NixOS/mobile-nixos/pull/28">#28</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Bringing the <a href="https://mobile.nixos.org/devices/index.html">total of devices to 10</a>.</p>
</div>
</div>
  </div>
</article>

<article>
  <header class="with-image" style="background-image: url('news/2019-12-03-november-2019-round-up.jpeg');">
    <div class="details">
      <h3><a href="news/2019-12-03-november-2019-round-up.html">November 2019 round-up</a></h3>
      <div class="date">December 3rd 2019</div>
    </div>
  </header>

  <div class="contents">
  <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This update is the first of a series of regular updates on the state of the
project.</p>
</div>
<div class="paragraph">
<p>Only changes that have been accepted and merged in Mobile NixOS are
chronicled here. There&#8217;s always <a href="https://github.com/NixOS/mobile-nixos/pulls">more work</a>
currently in-progress.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_notable_changes">Notable changes</h3>
<div class="paragraph">
<p>Among the changes, and the <a href="https://github.com/NixOS/mobile-nixos/pulls?utf8=%E2%9C%93&amp;q=is%3Apr+merged%3A2019-11">10 PRs merged</a>,
these changes are highlighted.</p>
</div>
<div class="sect3">
<h4 id="_initrd_add_fbterm_modules">initrd: add fbterm modules</h4>
<div class="paragraph">
<p>When the new <code>mobile.boot.stage-1.fbterm</code> options are enabled, a userspace
implementation of a console is started, attached to the output of tty1.
As of right now, this is a read-only view of the console.</p>
</div>
<div class="paragraph">
<p>This is still extremely useful on targets where the kernel-based virtual
consoles will not work. As long as the framebuffer is setup, you can use the
console to observe what is going on.</p>
</div>
<div class="paragraph">
<p>Added in <a href="https://github.com/NixOS/mobile-nixos/pull/46">pull request #46</a> by
<a href="https://github.com/lheckemann">@lheckemann</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_documentation_and_website_framework">Documentation and website framework</h4>
<div class="paragraph">
<p>This was briefly highlighted in the last news item, though let&#8217;s describe how
the documentation and website generation ticks.</p>
</div>
<div class="paragraph">
<p>The generated documentation in the repository is always built
using the <a href="https://github.com/NixOS/mobile-nixos/tree/master/doc">same exact tooling</a>
as the website. In fact, the website is only adding files to the documentation
directory to build itself.</p>
</div>
<div class="paragraph">
<p>This gives us the advantage of the documentation being trivial to build locally.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>~/.../mobile-nixos $ nix-build ./doc/
these derivations will be built:
  /nix/store/eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee-mobile-nixos-docs.drv
[...]
/nix/store/eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee-mobile-nixos-docs

~/.../mobile-nixos $ ls -l result/index.html
-r--r--r-- 4 root root 1541 Dec 31  1969 result/index.html

~/.../mobile-nixos/mobile-nixos-website $ xdg-open result/index.html
[...]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The documentation, minus the news items, will open in your web browser, and work
just like this website. The styles, the site map, everything is generated 1:1
compared to the website.</p>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/NixOS/mobile-nixos-website">mobile-nixos-website</a>
repository holds the <a href="https://github.com/NixOS/mobile-nixos-website/blob/master/.github/workflows/website.yml">
machinery</a> that updates the site, in addition to the <a href="https://github.com/NixOS/mobile-nixos-website/tree/master/website">news items</a>.
This is where content specific for the website is written.</p>
</div>
<div class="paragraph">
<p>You may also want to subscribe to the new <a href="https://mobile.nixos.org/index.xml">RSS feed</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_new_ports">New ports</h4>
<div class="paragraph">
<p>Three new devices were merged this month.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Google Pixel XL (google-marlin) [<a href="https://github.com/danielfullmer">@danielfullmer</a>] (<a href="https://github.com/NixOS/mobile-nixos/pull/51">#51</a>)</p>
</li>
<li>
<p>Google Pixel 2 (google-walleye) [<a href="https://github.com/samueldr">@samueldr</a>] (<a href="https://github.com/NixOS/mobile-nixos/pull/50">#50</a>)</p>
</li>
<li>
<p>Xiaomi A1 (xiaomi-tissot) [<a href="https://github.com/lheckemann">@lheckemann</a>] (<a href="https://github.com/NixOS/mobile-nixos/pull/47">#47</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Pixel devices should be trivial to adapt to their respective non-XL and XL
variants.</p>
</div>
</div>
</div>
  </div>
</article>

<article>
  <header class="with-image" style="background-image: url('news/2019-11-15-nixcon-wrap-up.jpeg'); background-position: left center;">
    <div class="details">
      <h3><a href="news/2019-11-15-nixcon-wrap-up.html">NixCon Wrap-Up and Website</a></h3>
      <div class="date">November 15th 2019</div>
    </div>
  </header>

  <div class="contents">
  <div class="paragraph">
<p>This past October, on the 25th, a talk about Mobile NixOS was held at NixCon
2019, in Brno, Czechia. The talk was recorded and is
<a href="https://www.youtube.com/watch?v=229PpjZZouw">on the NixCon YouTube page</a>.</p>
</div>
<div class="paragraph">
<p>Bringing us to the next point: this new and shiny website. This is was described
as the next step for the project. This website is built by blurring the
difference between the documentation of the project and the website. This means
that, hopefully, neither the website or the documentation will lag behind in
relevance. Additionally, building the site and contributing should be as simple
as contributing to the documentation. Hopefully simple enough.</p>
</div>
<div class="paragraph">
<p>Last, but not least, a few notes about the Hackday at the 2019 NixCon. I was
left with approximately no time to work on things myself, but instead was found
surrounded by bright individuals contributing neat stuff to the project.
<a href="https://github.com/NixOS/mobile-nixos/pulls?utf8=%E2%9C%93&amp;q=is%3Apr+created%3A2019-10-28+created%3A2019-10-27+created%3A2019-10-26">Those pull requests</a> are a good sample of what was done,
though early work on the OnePlus 5 was not advanced enough to be contributed back.</p>
</div>
<div class="paragraph">
<p>Wrapping this all nicely, I found that the main issue contributors around me had
was the lack of documentation about the porting process. I knew it was an issue,
hopefully this new website and progressing documentation helps.</p>
</div>
  </div>
</article>


</section>

<section class="">
</section>
</div>
<footer id="footer">
  <nav>
    <ul>
      <li></li>
      
      <li><a href='https://github.com/NixOS/mobile-nixos-website//blob/master/website/index.adoc'>Page Source</a></li>
      <li><a href='https://github.com/NixOS/mobile-nixos-website//edit/master/website/index.adoc'>Edit</a></li>
      
      <li><a href='sitemap.html' class=''>Site Map</a></li>
    </ul>
  </nav>
</footer>

</body>
</html>